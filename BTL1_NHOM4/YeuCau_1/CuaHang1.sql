ALTER USER CH1 QUOTA UNLIMITED ON USERS;
ALTER SESSION SET NLS_DATE_FORMAT =' DD/MM/YYYY HH24:MI:SS ';
Set serverOutput on;

Drop TABLE CH1.DIENTHOAI;
Drop TABLE CH1.CUAHANG;
Drop TABLE CH1.KHOHANG_QLKHO;
Drop TABLE CH1.KHOHANG_NVBH;
Drop TABLE CH1.NHANVIEN ;
Drop TABLE CH1.HOADON ;
Drop TABLE CH1.CTHD ;
Drop TABLE CH1.KHACHHANG ;

--------------------------------
CREATE TABLE CH1.DIENTHOAI 
(
    MaDT VARCHAR2(10) PRIMARY KEY,
    TenDT VARCHAR2(50),
    MauSac VARCHAR2(50),
    DungLuong VARCHAR2(50),
    GiaTien NUMBER,
    ThuongHieu VARCHAR2(50)
    
);

CREATE TABLE CH1.CUAHANG
(
    MaCH VARCHAR2(5) PRIMARY KEY,
    TenCH VARCHAR2(50),
    SoDT VARCHAR2(11)
    
);

CREATE TABLE  CH1.KHOHANG_QLKHO
(
    MaCH VARCHAR2(5),
    MaDT VARCHAR2(10),
    SoLuong NUMBER,
    NgayNhapKho DATE,
     CONSTRAINT PK_KHOHANG_QLKHO PRIMARY KEY(MaCH,MaDT), 
    CONSTRAINT FK_KHOHANG_QLKHO_CUAHANG FOREIGN KEY (MaCH)
    REFERENCES CH1.CUAHANG (MaCH),
      CONSTRAINT FK_KHOHANG_QLKHO_DIENTHOAI FOREIGN KEY (MaDT)
    REFERENCES CH1.DIENTHOAI(MaDT)

);

CREATE TABLE CH1.KHOHANG_NVBH
(
    MaCH VARCHAR2(5),
    MaDT VARCHAR2(10),
    TinhTrang  VARCHAR2(10), 
     CONSTRAINT PK_KHOHANG_NVBH PRIMARY KEY(MaCH,MaDT), 
    CONSTRAINT FK_KHOHANG_NVBH_CUAHANG FOREIGN KEY (MaCH)
    REFERENCES CH1.CUAHANG (MaCH),
      CONSTRAINT FK_KHOHANG_NVBH_DIENTHOAI FOREIGN KEY (MaDT)
    REFERENCES CH1.DIENTHOAI(MaDT)
);

CREATE TABLE CH1.NHANVIEN 
(
    MaNV VARCHAR2(5) PRIMARY KEY,
    TenNV VARCHAR2(50),
    DiaChi  VARCHAR2(50),
    SoDT VARCHAR2(11),
    Luong NUMBER,
    MaCH VARCHAR2(5),
    CONSTRAINT FK_NHANVIEN_CUAHANG FOREIGN KEY (MaCH)
    REFERENCES CH1.CUAHANG (MaCH)
);

CREATE TABLE CH1.KHACHHANG
(
    MaKH VARCHAR2(5) PRIMARY KEY,
    TenKH VARCHAR2(50),
    DiaChi  VARCHAR2(50),
    SoDT VARCHAR2(11)
);

CREATE TABLE CH1.HOADON 
(
    MaHD VARCHAR2(5) PRIMARY KEY,
    MaNV VARCHAR2(5),
    MaKH VARCHAR2(5), 
    MaCH VARCHAR2(5),
    NgayHD DATE,
    ThanhTien NUMBER,
    CONSTRAINT FK_HOADON_NHANVIEN FOREIGN KEY (MaNV)
        REFERENCES CH1.NHANVIEN (MaNV),
    CONSTRAINT FK_HOADON_KHACHHANG FOREIGN KEY (MaKH)
        REFERENCES CH1.KHACHHANG (MaKH),
    CONSTRAINT FK_HOADON_CUAHANG FOREIGN KEY (MaCH)
        REFERENCES CH1.CUAHANG (MaCH)
);

CREATE TABLE CH1.CTHD 
(
    MaHD VARCHAR2(5),
    MaDT VARCHAR2(10),
    SoLuong NUMBER, 
    CONSTRAINT PK_CTHD PRIMARY KEY(MaHD,MaDT), 
    CONSTRAINT FK_CTHD_HOADON FOREIGN KEY (MaHD)
        REFERENCES CH1.HOADON (MaHD),
    CONSTRAINT FK_CTHD_DIENTHOAI FOREIGN KEY (MaDT)
        REFERENCES CH1.DIENTHOAI (MaDT)
);


--Delete Dữ liệu
DELETE FROM CH1.CTHD;
DELETE FROM CH1.HOADON;
DELETE FROM CH1.KHACHHANG;
DELETE FROM CH1.NHANVIEN;
DELETE FROM CH1.KHOHANG_NVBH;
DELETE FROM CH1.KHOHANG_QLKHO;
DELETE FROM CH1.CUAHANG;
DELETE FROM CH1.DIENTHOAI;
-----------------------------------------------
-- INSERT DU LIEU

-- 1/ DIENTHOAI
DELETE FROM CH1.DIENTHOAI;

INSERT INTO CH1.DIENTHOAI VALUES ('Phone01','Iphone 12','Black','64GB',18290000,'Apple');
INSERT INTO CH1.DIENTHOAI VALUES ('Phone02','Iphone 12','Red','64GB',18290000,'Apple');
INSERT INTO CH1.DIENTHOAI VALUES ('Phone03','Iphone 12','Blue','64GB',18290000,'Apple');
INSERT INTO CH1.DIENTHOAI VALUES ('Phone04','Iphone 12','White','64GB',18290000,'Apple');

INSERT INTO CH1.DIENTHOAI VALUES ('Phone05','Iphone 12','Black','128GB',19590000,'Apple');
INSERT INTO CH1.DIENTHOAI VALUES ('Phone06','Iphone 12','Red','128GB',19590000,'Apple');
INSERT INTO CH1.DIENTHOAI VALUES ('Phone07','Iphone 12','Blue','128GB',19590000,'Apple');
INSERT INTO CH1.DIENTHOAI VALUES ('Phone08','Iphone 12','White','128GB',19590000,'Apple');

INSERT INTO CH1.DIENTHOAI VALUES ('Phone09','Iphone 12','Black','256GB',22390000,'Apple');
INSERT INTO CH1.DIENTHOAI VALUES ('Phone10','Iphone 12','Red','256GB',22390000,'Apple');
INSERT INTO CH1.DIENTHOAI VALUES ('Phone11','Iphone 12','Blue','256GB',22390000,'Apple');

INSERT INTO CH1.DIENTHOAI VALUES ('Phone12','Iphone 13','Midnight','64GB',21590000,'Apple');
INSERT INTO CH1.DIENTHOAI VALUES ('Phone13','Iphone 13','Red','64GB',21590000,'Apple');
INSERT INTO CH1.DIENTHOAI VALUES ('Phone14','Iphone 13','Blue','64GB',21590000,'Apple');

INSERT INTO CH1.DIENTHOAI VALUES ('Phone15','Iphone 13','Midnight','128GB',24190000,'Apple');
INSERT INTO CH1.DIENTHOAI VALUES ('Phone16','Iphone 13','Red','128GB',24190000,'Apple');
INSERT INTO CH1.DIENTHOAI VALUES ('Phone17','Iphone 13','Blue','128GB',24190000,'Apple');

INSERT INTO CH1.DIENTHOAI VALUES ('Phone18','Iphone 13','Midnight','256GB',29490000,'Apple');
INSERT INTO CH1.DIENTHOAI VALUES ('Phone19','Iphone 13','Red','256GB',29490000,'Apple');
INSERT INTO CH1.DIENTHOAI VALUES ('Phone20','Iphone 13','Blue','256GB',29490000,'Apple');

INSERT INTO CH1.DIENTHOAI VALUES ('Phone21','Samsung Galaxy Z Fold3 5G','Black','256GB',41999000,'Samsung');
INSERT INTO CH1.DIENTHOAI VALUES ('Phone22','Samsung Galaxy Z Fold3 5G','Grey','256GB',41999000,'Samsung');
INSERT INTO CH1.DIENTHOAI VALUES ('Phone23','Samsung Galaxy Z Fold3 5G','Blue','256GB',41999000,'Samsung');

INSERT INTO CH1.DIENTHOAI VALUES ('Phone24','Samsung Galaxy Z Fold3 5G','Black','512GB',45000000,'Samsung');
INSERT INTO CH1.DIENTHOAI VALUES ('Phone25','Samsung Galaxy Z Fold3 5G','Grey','512GB',45000000,'Samsung');
INSERT INTO CH1.DIENTHOAI VALUES ('Phone26','Samsung Galaxy Z Fold3 5G','Blue','512GB',45000000,'Samsung');

INSERT INTO CH1.DIENTHOAI VALUES ('Phone27','Samsung Galaxy Z Flip3 5G','Black ','128GB',24990000,'Samsung');
INSERT INTO CH1.DIENTHOAI VALUES ('Phone28','Samsung Galaxy Z Flip3 5G','Blue','128GB',24990000,'Samsung');
INSERT INTO CH1.DIENTHOAI VALUES ('Phone29','Samsung Galaxy Z Flip3 5G','White','128GB',24990000,'Samsung');
INSERT INTO CH1.DIENTHOAI VALUES ('Phone30','Samsung Galaxy Z Flip3 5G','Purple','128GB',24990000,'Samsung');

INSERT INTO CH1.DIENTHOAI VALUES ('Phone31','Samsung Galaxy Z Flip3 5G','Black','256GB',26990000,'Samsung');
INSERT INTO CH1.DIENTHOAI VALUES ('Phone32','Samsung Galaxy Z Flip3 5G','Blue','256GB',26990000,'Samsung');
INSERT INTO CH1.DIENTHOAI VALUES ('Phone33','Samsung Galaxy Z Flip3 5G','White','256GB',26990000,'Samsung');
INSERT INTO CH1.DIENTHOAI VALUES ('Phone34','Samsung Galaxy Z Flip3 5G','Purple','256GB',26990000,'Samsung');

INSERT INTO CH1.DIENTHOAI VALUES ('Phone35','Samsung Galaxy A22','Purple','128GB',5390000,'Samsung');
INSERT INTO CH1.DIENTHOAI VALUES ('Phone36','Samsung Galaxy A22','Black','128GB',5390000,'Samsung');
INSERT INTO CH1.DIENTHOAI VALUES ('Phone37','Samsung Galaxy A22','Green','128GB',5390000,'Samsung');

INSERT INTO CH1.DIENTHOAI VALUES ('Phone38','Xiaomi 11T 5G','Blue','128GB',5390000,'Xiaomi');
INSERT INTO CH1.DIENTHOAI VALUES ('Phone39','Xiaomi 11T 5G','White','128GB',5390000,'Xiaomi');
INSERT INTO CH1.DIENTHOAI VALUES ('Phone40','Xiaomi 11T 5G','Grey','128GB',5390000,'Xiaomi');

INSERT INTO CH1.DIENTHOAI VALUES ('Phone41','Vsmart Aris','Blue','128GB',4490000,'Vsmart');
INSERT INTO CH1.DIENTHOAI VALUES ('Phone42','Vsmart Aris','Grey','128GB',4490000,'Vsmart');
INSERT INTO CH1.DIENTHOAI VALUES ('Phone43','Vsmart Aris','Green','128GB',4490000,'Vsmart');

INSERT INTO CH1.DIENTHOAI VALUES ('Phone44','Vsmart Aris Pro','Grey','128GB',5150000,'Vsmart');
INSERT INTO CH1.DIENTHOAI VALUES ('Phone45','Vsmart Aris Pro','Green','128GB',5150000,'Vsmart');
INSERT INTO CH1.DIENTHOAI VALUES ('Phone46','Vsmart Aris Pro','Copper','128GB',5150000,'Vsmart');

INSERT INTO CH1.DIENTHOAI VALUES ('Phone47','Vivo Y21s','Midnight','128GB',5480000,'Vivo');
INSERT INTO CH1.DIENTHOAI VALUES ('Phone48','Vivo Y21s','White','128GB',5480000,'Vivo');

INSERT INTO CH1.DIENTHOAI VALUES ('Phone49','OPPO Reno6 5G','Black','128GB',12990000,'Oppo');
INSERT INTO CH1.DIENTHOAI VALUES ('Phone50','OPPO Reno6 5G','Grey','128GB',12990000,'Oppo');



-- 2/ CUA HANG
DELETE FROM CH1.CUAHANG;

INSERT INTO CH1.CUAHANG VALUES ('CH01','QUAN 1, TPHCM','09494499969');
INSERT INTO CH1.CUAHANG VALUES ('CH02','QUAN BA DINH, HA NOI','0995596624');

-- 3/ KHACH HANG --

DELETE FROM CH1.KHACHHANG;

INSERT INTO CH1.KHACHHANG VALUES ('KH01','Nguyen Minh Quan','QUAN 1, TPHCM','09494499969');
INSERT INTO CH1.KHACHHANG VALUES ('KH02','Le Minh Triet','QUAN 2, TPHCM','0995596624');
INSERT INTO CH1.KHACHHANG VALUES ('KH03','Hoang Minh Nam Phuong','QUAN 3, TPHCM','09822343455');
INSERT INTO CH1.KHACHHANG VALUES ('KH04','Dao Minh Duc','QUAN 4, TPHCM','0936934644');
INSERT INTO CH1.KHACHHANG VALUES ('KH05','Pham Thi Thao Nhi','QUAN 5, TPHCM','0944924928');
INSERT INTO CH1.KHACHHANG VALUES ('KH06','Vu My Ngoc','QUAN 6, TPHCM','09494499969');
INSERT INTO CH1.KHACHHANG VALUES ('KH07','Do Quang Vinh','QUAN 7, TPHCM','0949821299');
INSERT INTO CH1.KHACHHANG VALUES ('KH08','Nguyen Truong Hoang Nam','QUAN 8, TPHCM','09494499969');
INSERT INTO CH1.KHACHHANG VALUES ('KH09','Nguyen Phan Bao Chau','QUAN 9, TPHCM','0982999343');
INSERT INTO CH1.KHACHHANG VALUES ('KH10','Nguyen Le Nhat Vy','QUAN 10, TPHCM','0998555312');
INSERT INTO CH1.KHACHHANG VALUES ('KH11','Nguyen Thai Bao Ngoc','QUAN 11, TPHCM','09494499969');
INSERT INTO CH1.KHACHHANG VALUES ('KH12','Truong Gia Bao','QUAN 12, TPHCM','0938241489');
INSERT INTO CH1.KHACHHANG VALUES ('KH13','Ngo Manh Hung','QUAN TAN BINH, TPHCM','0982991868');
INSERT INTO CH1.KHACHHANG VALUES ('KH14','Bui Nguyen Trung Thanh','QUAN BINH TAN, TPHCM','09494499969');
INSERT INTO CH1.KHACHHANG VALUES ('KH15','Ngac Bao Vinh','QUAN BINH THANH, TPHCM','0949165339');
INSERT INTO CH1.KHACHHANG VALUES ('KH16','Phan Bao Chau','QUAN GO VAP, TPHCM','09494499969');
INSERT INTO CH1.KHACHHANG VALUES ('KH17','Tran Nguyen Phuoc Tai','QUAN PHU NHUAN, TPHCM','09528392386');
INSERT INTO CH1.KHACHHANG VALUES ('KH18','Tran An Nguyen','QUAN TAN PHU, TPHCM','0993394146');
INSERT INTO CH1.KHACHHANG VALUES ('KH19','Huynh Hoang Bao Ngoc','QUAN THU DUC, TPHCM','09528392386');
INSERT INTO CH1.KHACHHANG VALUES ('KH20','Nguyen Tran Yen Nhi','HUYEN BINH CHANH, TPHCM','09494499969');
INSERT INTO CH1.KHACHHANG VALUES ('KH21','Pham Hoang Vinh','HUYEN CAN GIO, TPHCM','09494499969');
INSERT INTO CH1.KHACHHANG VALUES ('KH22','Tran Ngoc Vu','HUYEN CU CHI, TPHCM','0994193243');
INSERT INTO CH1.KHACHHANG VALUES ('KH23','Tran Dang Khoa','HUYEN HOC MON, TPHCM','0942244615');
INSERT INTO CH1.KHACHHANG VALUES ('KH24','Nguyen Thien An','HUYEN NHA BE, TPHCM','0989968144');
INSERT INTO CH1.KHACHHANG VALUES ('KH25','Le Vo Ngoc Nhi','QUAN HOAN KIEM, HA NOI','0993362892');
INSERT INTO CH1.KHACHHANG VALUES ('KH26','Pham Quang Huy','QUAN DONG DA, HA NOI','09499594949');
INSERT INTO CH1.KHACHHANG VALUES ('KH27','Chu Minh Duc','QUAN BA DINH, HA NOI','0992426225');
INSERT INTO CH1.KHACHHANG VALUES ('KH28','Nguyen Thanh Dat','QUAN HAI BA TRUNG, HA NOI','09528392386');
INSERT INTO CH1.KHACHHANG VALUES ('KH29','Phung Duc Thien','QUAN HOANG MAI, HA NOI','09528392386');
INSERT INTO CH1.KHACHHANG VALUES ('KH30','Dang Ngoc Anh Thi','QUAN THANH XUAN, HA NOI','09494499969');
INSERT INTO CH1.KHACHHANG VALUES ('KH31','Lai Mai Thanh Thao','QUAN LONG BIEN, HA NOI','09834525696');
INSERT INTO CH1.KHACHHANG VALUES ('KH32','Tran Do Hoang Long','QUAN NAM TU LIEM, HA NOI','0944899489');
INSERT INTO CH1.KHACHHANG VALUES ('KH33','Banh Gia Linh','QUAN BAC TU LIEM, HA NOI','09494499969');
INSERT INTO CH1.KHACHHANG VALUES ('KH34','Bui Quang Huy','QUAN TAY HO, HA NOI','0946924915');
INSERT INTO CH1.KHACHHANG VALUES ('KH35','Nguyen Dac Hong Anh','QUAN CAU GIAY, HA NOI','0993916948');
INSERT INTO CH1.KHACHHANG VALUES ('KH36','Le Hana','QUAN HA DONG, HA NOI','09364632242');
INSERT INTO CH1.KHACHHANG VALUES ('KH37','Pham Thi Bao Tram','THI XA SON TAY, HA NOI','0931441445');
INSERT INTO CH1.KHACHHANG VALUES ('KH38','Nguyen Gia Huy','HUYEN BA VI, HA NOI','0935116895');

INSERT INTO CH1.KHACHHANG VALUES ('KH39','To Dinh Gia Bao','HUYEN CHUONG MY, HA NOI','09528392386');
INSERT INTO CH1.KHACHHANG VALUES ('KH40','Mai Hieu Minh','HUYEN PHUC THO, HA NOI','09494499969');
INSERT INTO CH1.KHACHHANG VALUES ('KH41','Tran Ninh Khang','HUYEN DAN PHUONG, HA NOI','09528392386');
INSERT INTO CH1.KHACHHANG VALUES ('KH42','Nguyen Van Thanh Binh','HUYEN DONG ANH, HA NOI','09494499969');
INSERT INTO CH1.KHACHHANG VALUES ('KH43','Huynh Vo Tri Nhan','HUYEN GIA LAM, HA NOI','0983154412');
INSERT INTO CH1.KHACHHANG VALUES ('KH44','Hoang Diep Anh','HUYEN HOAI DUC, HA NOI','0991958924');
INSERT INTO CH1.KHACHHANG VALUES ('KH45','Cao Ba Ngoc','HUYEN ME LINH, HA NOI','0933223832');
INSERT INTO CH1.KHACHHANG VALUES ('KH46','Phan Tam An','HUYEN MY DUC, HA NOI','0995949124');
INSERT INTO CH1.KHACHHANG VALUES ('KH47','Vo Minh Thanh','HUYEN PHU XUYEN, HA NOI','09898699925');
INSERT INTO CH1.KHACHHANG VALUES ('KH48','Huynh Thai Son','HUYEN QUOC OAI, HA NOI','0966486839');
INSERT INTO CH1.KHACHHANG VALUES ('KH49','Nguyen Khanh Trinh','HUYEN SOC SON, HA NOI','09528392386');
INSERT INTO CH1.KHACHHANG VALUES ('KH50','Pham Ngoc Hai','HUYEN THACH THAT,HA NOI','09528392386');



--- 4/ Nhan Vien

INSERT INTO CH1.NHANVIEN VALUES ('NV01','Dao Thi Hong Ngoc','QUAN 1, TPHCM','09494499969',6300000,'CH01');
INSERT INTO CH1.NHANVIEN VALUES ('NV02','Ngo Thi Hong Anh','QUAN 1, TPHCM','0995596624',4000000,'CH01');
INSERT INTO CH1.NHANVIEN VALUES ('NV03','Nguyen Thi Kim Anh','QUAN 2, TPHCM','09822343455',5000000,'CH01');
INSERT INTO CH1.NHANVIEN VALUES ('NV04','Nguyen Hoang Mai Khoi','QUAN 2, TPHCM','0936934644',6500000,'CH01');
INSERT INTO CH1.NHANVIEN VALUES ('NV05','Tran Vu An Nhien','QUAN 2, TPHCM','0944924928',16000000,'CH01');
INSERT INTO CH1.NHANVIEN VALUES ('NV06','Le Huynh','QUAN 6, TPHCM','09494499969',16600000,'CH01');
INSERT INTO CH1.NHANVIEN VALUES ('NV07','Nguyen Dang Khoa','QUAN 7, TPHCM','0949821299',6000000,'CH01');
INSERT INTO CH1.NHANVIEN VALUES ('NV08','Nguyen Hoang Minh Quan','QUAN 8, TPHCM','09494499969',6000000,'CH01');
INSERT INTO CH1.NHANVIEN VALUES ('NV09','Pham Thi Thanh Truc','QUAN 9, TPHCM','0982999343',5900000,'CH01');
INSERT INTO CH1.NHANVIEN VALUES ('NV10','Nguyen Minh Cuong','QUAN 10, TPHCM','0998555312',5900000,'CH01');
INSERT INTO CH1.NHANVIEN VALUES ('NV11','Bui Thanh Trang','QUAN 11, TPHCM','09494499969',5900000,'CH01');
INSERT INTO CH1.NHANVIEN VALUES ('NV12','Banh Van Tran Phat','QUAN 12, TPHCM','0938241489',5900000,'CH01');
INSERT INTO CH1.NHANVIEN VALUES ('NV13','Tran Gia Han','QUAN TAN BINH, TPHCM','0982991868',4200000,'CH01');
INSERT INTO CH1.NHANVIEN VALUES ('NV14','Pham Khanh Han','QUAN BINH TAN, TPHCM','09494499969',4200000,'CH01');
INSERT INTO CH1.NHANVIEN VALUES ('NV15','Nguyen Huu Cuong','QUAN BINH THANH, TPHCM','0949165339',4200000,'CH01');
INSERT INTO CH1.NHANVIEN VALUES ('NV16','Nguyen Anh Tuan','QUAN GO VAP, TPHCM','09494499969',4200000,'CH01');
INSERT INTO CH1.NHANVIEN VALUES ('NV17','Tran Doan Kim Ngan','QUAN PHU NHUAN, TPHCM','09528392386',7500000,'CH01');
INSERT INTO CH1.NHANVIEN VALUES ('NV18','Duong Minh Khang','QUAN TAN PHU, TPHCM','0993394146',7500000,'CH01');
INSERT INTO CH1.NHANVIEN VALUES ('NV19','Hoang Tran Bao Long','QUAN THU DUC, TPHCM','09528392386',7500000,'CH01');
INSERT INTO CH1.NHANVIEN VALUES ('NV20','Le Nhat Nam','HUYEN BINH CHANH, TPHCM','09494499969',7500000,'CH01');
INSERT INTO CH1.NHANVIEN VALUES ('NV21','Dinh Nguyen Kim Anh','HUYEN CAN GIO, TPHCM','09494499969',7500000,'CH01');
INSERT INTO CH1.NHANVIEN VALUES ('NV22','Le Gia Huy','HUYEN CU CHI, TPHCM','0994193243',8000000,'CH01');
INSERT INTO CH1.NHANVIEN VALUES ('NV23','Le Trinh Hoang Phat','HUYEN HOC MON, TPHCM','0942244615',8000000,'CH01');
INSERT INTO CH1.NHANVIEN VALUES ('NV24','Cao Tran Nam Anh','HUYEN NHA BE, TPHCM','0989968144',8000000,'CH01');
INSERT INTO CH1.NHANVIEN VALUES ('NV25','Phan To Nhu','QUAN HOAN KIEM, HA NOI','0993362892',6100000,'CH01');




-- 5/ KHOHANG_QLKHO --


INSERT INTO CH1.KHOHANG_QLKHO VALUES ('CH01','Phone01',100,'29/10/2021');
INSERT INTO CH1.KHOHANG_QLKHO VALUES ('CH01','Phone02',200,'29/10/2021');
INSERT INTO CH1.KHOHANG_QLKHO VALUES ('CH01','Phone03',200,'29/10/2021');
INSERT INTO CH1.KHOHANG_QLKHO VALUES ('CH01','Phone05',200,'29/10/2021');
INSERT INTO CH1.KHOHANG_QLKHO VALUES ('CH01','Phone06',100,'29/10/2021');
INSERT INTO CH1.KHOHANG_QLKHO VALUES ('CH01','Phone08',150,'29/10/2021');
INSERT INTO CH1.KHOHANG_QLKHO VALUES ('CH01','Phone09',150,'29/10/2021');
INSERT INTO CH1.KHOHANG_QLKHO VALUES ('CH01','Phone10',150,'29/10/2021');
INSERT INTO CH1.KHOHANG_QLKHO VALUES ('CH01','Phone12',150,'29/10/2021');
INSERT INTO CH1.KHOHANG_QLKHO VALUES ('CH01','Phone14',150,'29/10/2021');

INSERT INTO CH1.KHOHANG_QLKHO VALUES ('CH01','Phone16',100,'30/10/2021');
INSERT INTO CH1.KHOHANG_QLKHO VALUES ('CH01','Phone17',100,'30/10/2021');
INSERT INTO CH1.KHOHANG_QLKHO VALUES ('CH01','Phone18',125,'30/10/2021');
INSERT INTO CH1.KHOHANG_QLKHO VALUES ('CH01','Phone22',125,'30/10/2021');
INSERT INTO CH1.KHOHANG_QLKHO VALUES ('CH01','Phone23',125,'30/10/2021');
INSERT INTO CH1.KHOHANG_QLKHO VALUES ('CH01','Phone25',125,'30/10/2021');
INSERT INTO CH1.KHOHANG_QLKHO VALUES ('CH01','Phone26',175,'30/10/2021');
INSERT INTO CH1.KHOHANG_QLKHO VALUES ('CH01','Phone27',175,'30/10/2021');
INSERT INTO CH1.KHOHANG_QLKHO VALUES ('CH01','Phone30',175,'30/10/2021');
INSERT INTO CH1.KHOHANG_QLKHO VALUES ('CH01','Phone31',175,'30/10/2021');

INSERT INTO CH1.KHOHANG_QLKHO VALUES ('CH01','Phone32',250,'01/11/2021');
INSERT INTO CH1.KHOHANG_QLKHO VALUES ('CH01','Phone34',250,'01/11/2021');
INSERT INTO CH1.KHOHANG_QLKHO VALUES ('CH01','Phone35',250,'01/11/2021');
INSERT INTO CH1.KHOHANG_QLKHO VALUES ('CH01','Phone37',250,'05/11/2021');
INSERT INTO CH1.KHOHANG_QLKHO VALUES ('CH01','Phone38',275,'05/11/2021');
INSERT INTO CH1.KHOHANG_QLKHO VALUES ('CH01','Phone40',275,'05/11/2021');
INSERT INTO CH1.KHOHANG_QLKHO VALUES ('CH01','Phone41',275,'05/11/2021');
INSERT INTO CH1.KHOHANG_QLKHO VALUES ('CH01','Phone42',275,'05/11/2021');
INSERT INTO CH1.KHOHANG_QLKHO VALUES ('CH01','Phone44',300,'07/11/2021');
INSERT INTO CH1.KHOHANG_QLKHO VALUES ('CH01','Phone49',300,'07/11/2021');



-- 6/ KHOHANG_NVBH -- 


INSERT INTO CH1.KHOHANG_NVBH VALUES ('CH01','Phone01','Het hang');
INSERT INTO CH1.KHOHANG_NVBH VALUES ('CH01','Phone02','Het hang');
INSERT INTO CH1.KHOHANG_NVBH VALUES ('CH01','Phone03','Het hang');
INSERT INTO CH1.KHOHANG_NVBH VALUES ('CH01','Phone05','Het hang');
INSERT INTO CH1.KHOHANG_NVBH VALUES ('CH01','Phone06','Het hang');
INSERT INTO CH1.KHOHANG_NVBH VALUES ('CH01','Phone08','Het hang');
INSERT INTO CH1.KHOHANG_NVBH VALUES ('CH01','Phone09','Con hang');
INSERT INTO CH1.KHOHANG_NVBH VALUES ('CH01','Phone10','Con hang');
INSERT INTO CH1.KHOHANG_NVBH VALUES ('CH01','Phone12','Con hang');
INSERT INTO CH1.KHOHANG_NVBH VALUES ('CH01','Phone14','Con hang');

INSERT INTO CH1.KHOHANG_NVBH VALUES ('CH01','Phone16','Con hang');
INSERT INTO CH1.KHOHANG_NVBH VALUES ('CH01','Phone17','Con hang');
INSERT INTO CH1.KHOHANG_NVBH VALUES ('CH01','Phone18','Con hang');
INSERT INTO CH1.KHOHANG_NVBH VALUES ('CH01','Phone22','Con hang');
INSERT INTO CH1.KHOHANG_NVBH VALUES ('CH01','Phone23','Con hang');
INSERT INTO CH1.KHOHANG_NVBH VALUES ('CH01','Phone25','Con hang');
INSERT INTO CH1.KHOHANG_NVBH VALUES ('CH01','Phone26','Con hang');
INSERT INTO CH1.KHOHANG_NVBH VALUES ('CH01','Phone27','Con hang');
INSERT INTO CH1.KHOHANG_NVBH VALUES ('CH01','Phone30','Con hang');
INSERT INTO CH1.KHOHANG_NVBH VALUES ('CH01','Phone31','Con hang');

INSERT INTO CH1.KHOHANG_NVBH VALUES ('CH01','Phone32','Con hang');
INSERT INTO CH1.KHOHANG_NVBH VALUES ('CH01','Phone34','Con hang');
INSERT INTO CH1.KHOHANG_NVBH VALUES ('CH01','Phone35','Con hang');
INSERT INTO CH1.KHOHANG_NVBH VALUES ('CH01','Phone37','Con hang');
INSERT INTO CH1.KHOHANG_NVBH VALUES ('CH01','Phone38','Con hang');
INSERT INTO CH1.KHOHANG_NVBH VALUES ('CH01','Phone40','Con hang');
INSERT INTO CH1.KHOHANG_NVBH VALUES ('CH01','Phone41','Con hang');
INSERT INTO CH1.KHOHANG_NVBH VALUES ('CH01','Phone42','Con hang');
INSERT INTO CH1.KHOHANG_NVBH VALUES ('CH01','Phone44','Con hang');
INSERT INTO CH1.KHOHANG_NVBH VALUES ('CH01','Phone49','Con hang');




-- 7/ HOADON -- 
DELETE FROM CH1.HOADON;


INSERT INTO CH1.HOADON VALUES ('HD01','NV01','KH01','CH01','30/10/2021',22390000);
INSERT INTO CH1.HOADON VALUES ('HD02','NV01','KH01','CH01','30/10/2021',44780000);
INSERT INTO CH1.HOADON VALUES ('HD03','NV01','KH02','CH01','30/10/2021',21590000);
INSERT INTO CH1.HOADON VALUES ('HD04','NV05','KH03','CH01','30/10/2021',64770000);
INSERT INTO CH1.HOADON VALUES ('HD05','NV10','KH04','CH01','30/10/2021',24190000);
INSERT INTO CH1.HOADON VALUES ('HD06','NV15','KH06','CH01','30/10/2021',24190000);
INSERT INTO CH1.HOADON VALUES ('HD07','NV24','KH08','CH01','30/10/2021',29490000);
INSERT INTO CH1.HOADON VALUES ('HD08','NV03','KH10','CH01','30/10/2021',41999000);
INSERT INTO CH1.HOADON VALUES ('HD09','NV04','KH11','CH01','30/10/2021',90000000);
INSERT INTO CH1.HOADON VALUES ('HD10','NV06','KH12','CH01','30/10/2021',90000000);

INSERT INTO CH1.HOADON VALUES ('HD11','NV07','KH15','CH01','31/10/2021',49980000);
INSERT INTO CH1.HOADON VALUES ('HD12','NV20','KH18','CH01','31/10/2021',74970000);
INSERT INTO CH1.HOADON VALUES ('HD13','NV01','KH20','CH01','31/10/2021',80970000);
INSERT INTO CH1.HOADON VALUES ('HD14','NV01','KH21','CH01','31/10/2021',26990000);
INSERT INTO CH1.HOADON VALUES ('HD15','NV01','KH22','CH01','31/10/2021',26990000);
INSERT INTO CH1.HOADON VALUES ('HD16','NV01','KH22','CH01','01/11/2021',5480000);
INSERT INTO CH1.HOADON VALUES ('HD17','NV01','KH22','CH01','01/11/2021',5480000);
INSERT INTO CH1.HOADON VALUES ('HD18','NV01','KH30','CH01','01/11/2021',5390000);
INSERT INTO CH1.HOADON VALUES ('HD19','NV01','KH32','CH01','01/11/2021',22390000);
INSERT INTO CH1.HOADON VALUES ('HD20','NV01','KH33','CH01','07/11/2021',22390000);

INSERT INTO CH1.HOADON VALUES ('HD21','NV01','KH43','CH01','07/11/2021',4490000);
INSERT INTO CH1.HOADON VALUES ('HD22','NV01','KH44','CH01','07/11/2021',4490000);
INSERT INTO CH1.HOADON VALUES ('HD23','NV01','KH45','CH01','07/11/2021',4490000);
INSERT INTO CH1.HOADON VALUES ('HD24','NV01','KH46','CH01','07/11/2021',4490000);
INSERT INTO CH1.HOADON VALUES ('HD25','NV01','KH47','CH01','07/11/2021',4490000);


-- 8/ CTHD 


INSERT INTO CH1.CTHD VALUES ('HD01','Phone09',01);
INSERT INTO CH1.CTHD VALUES ('HD02','Phone10',02);
INSERT INTO CH1.CTHD VALUES ('HD03','Phone12',01);
INSERT INTO CH1.CTHD VALUES ('HD04','Phone14',03);
INSERT INTO CH1.CTHD VALUES ('HD05','Phone16',01);
INSERT INTO CH1.CTHD VALUES ('HD06','Phone17',01);
INSERT INTO CH1.CTHD VALUES ('HD07','Phone18',01);
INSERT INTO CH1.CTHD VALUES ('HD08','Phone22',01);
INSERT INTO CH1.CTHD VALUES ('HD09','Phone25',02);
INSERT INTO CH1.CTHD VALUES ('HD10','Phone26',02);

INSERT INTO CH1.CTHD VALUES ('HD11','Phone27',02);
INSERT INTO CH1.CTHD VALUES ('HD12','Phone30',03);
INSERT INTO CH1.CTHD VALUES ('HD13','Phone31',03);
INSERT INTO CH1.CTHD VALUES ('HD14','Phone32',01);
INSERT INTO CH1.CTHD VALUES ('HD15','Phone34',01);
INSERT INTO CH1.CTHD VALUES ('HD16','Phone47',01);
INSERT INTO CH1.CTHD VALUES ('HD17','Phone48',01);
INSERT INTO CH1.CTHD VALUES ('HD18','Phone40',01);
INSERT INTO CH1.CTHD VALUES ('HD19','Phone09',01);
INSERT INTO CH1.CTHD VALUES ('HD20','Phone10',01);

INSERT INTO CH1.CTHD VALUES ('HD21','Phone41',01);
INSERT INTO CH1.CTHD VALUES ('HD22','Phone41',01);
INSERT INTO CH1.CTHD VALUES ('HD23','Phone42',01);
INSERT INTO CH1.CTHD VALUES ('HD24','Phone42',01);
INSERT INTO CH1.CTHD VALUES ('HD25','Phone42',01);
INSERT INTO CH1.CTHD VALUES ('HD16','Phone48',03);
commit


-------------------------------------------------------

-- ==========================  Yeu Cau 1 ===================================---


--// Cau 1 \\ --
-- Tài khoản quản lý kho:
--  Đưa ra thông tin điện thoại của thương hiệu “Apple�? gồm mã điện thoại, tên điện thoại, màu sắc, dung lượng, ngày nhập kho ở cửa hàng mình quản lý

SELECT DT1.MADT, TENDT, MAUSAC, DUNGLUONG, NGAYNHAPKHO
FROM CH1.DIENTHOAI DT1 JOIN CH1.KHOHANG_QLKHO QL1 ON DT1.MADT=QL1.MADT
WHERE THUONGHIEU = 'Apple' 


--// Cau 2\\ --
-- Tài khoản trưởng cửa hàng: Tìm khách hàng mua hàng ở cửa hàng 1 mà không mua ở cửa hàng 2

SELECT DISTINCT(HD1.MAKH) FROM CH1.HOADON HD1 
WHERE HD1.MAKH NOT IN (SELECT HD2.MAKH FROM CH2.HOADON@truongch1_dblink HD2)
ORDER BY HD1.MAKH 

--// Cau 3\\ --
--Tài khoản trưởng cửa hàng: Tìm khách hàng (MaKH) đã mua tất cả điện thoại của thương hiệu Vivo ở cửa hàng mình quản lý

SELECT MAKH 
FROM CH1.HOADON HD 
WHERE NOT EXISTS 
(SELECT * FROM CH1.DIENTHOAI DT 
WHERE THUONGHIEU = 'Vivo' AND NOT EXISTS 
    (SELECT * FROM CH1.CTHD CT WHERE CT.MAHD=HD.MAHD AND CT.MADT=DT.MADT)) 



--// Cau 4\\ --
-- Tài khoản nhân viên: Tìm thông tin điện thoại (MaDT, TenDT) được phân phối đến tất cả cửa hàng với tình trạng còn hàng.
SELECT DT1.MADT, TENDT 
FROM CH1.DIENTHOAI DT1 JOIN CH1.KHOHANG_NVBH NVBH1 
ON DT1.MADT = NVBH1.MADT 
WHERE TINHTRANG ='Con hang' 
INTERSECT
SELECT DT2.MADT, DT2.TENDT 
FROM CH2.DIENTHOAI@nv1_dblink DT2 JOIN CH2.KHOHANG_NVBH@nv1_dblink NVBH2 
ON DT2.MADT = NVBH2.MADT 
WHERE TINHTRANG ='Con hang' 


--// Cau 5\\ --
--Tài khoản giám đốc: đưa ra thông tin tất cả nhân viên (MaNV, TenNV) tại cả 2 chi nhánh có mức lương từ 7 triệu trở lên
SELECT MANV, TENNV FROM CH1.NHANVIEN WHERE LUONG >= 7000000
UNION
SELECT MANV, TENNV FROM CH2.NHANVIEN@giamdoc1_dblink WHERE LUONG >=7000000


--// Cau 6\\ --
--Tài khoản giám đốc: đưa ra thông tin 3 điện thoại bán chạy nhất trong tháng 11 theo từng cửa hàng. Thông tin hiển thị gồm MaCH, MaDT, TenDT
SELECT * 
FROM (SELECT CT1.MADT, TENDT, MAUSAC, MACH, SUM(SOLUONG) 
FROM CH1.DIENTHOAI DT1, CH1.HOADON HD1, CH1.CTHD CT1
WHERE DT1.MADT=CT1.MADT AND CT1.MAHD=HD1.MAHD AND To_char(NGAYHD,'MM')='11' 
GROUP BY CT1.MADT, TENDT, MAUSAC, MACH 
ORDER BY SUM(SOLUONG) DESC) 
WHERE ROWNUM <=3
UNION
SELECT * 
FROM (SELECT CT2.MADT, TENDT, MAUSAC, MACH, SUM(SOLUONG) 
FROM CH2.DIENTHOAI@giamdoc1_dblink DT2, CH2.HOADON@giamdoc1_dblink HD2, CH2.CTHD@giamdoc1_dblink CT2 
WHERE DT2.MADT=CT2.MADT AND CT2.MAHD=HD2.MAHD AND To_char(NGAYHD,'MM')='11' 
GROUP BY CT2.MADT, TENDT, MAUSAC, MACH ORDER BY SUM(SOLUONG) DESC) 
WHERE ROWNUM <=3


--// Cau 7\\ --
-- Tài khoản giám đốc: Tính tổng doanh thu trong tháng 11 ở mỗi cửa hàng
SELECT HD1.MACH, SUM(THANHTIEN) DOANH_THU FROM CH1.HOADON HD1 
WHERE To_char(NGAYHD,'MM')='11' GROUP BY HD1.MACH
UNION
SELECT HD2.MACH, SUM(THANHTIEN) DOANH_THU FROM CH2.HOADON@giamdoc1_dblink HD2 
WHERE To_char(NGAYHD,'MM')='11' GROUP BY HD2.MACH

--// Cau 8\\ --
-- Tài khoản giám đốc: In ra danh sách các điện thoại (MaDT, TenDT) không bán được ở tất cả cửa hàng
Connect

SELECT MADT, TENDT FROM CH1.DIENTHOAI 
WHERE MADT NOT IN (SELECT MADT FROM CH1.CTHD)
INTERSECT
SELECT MADT, TENDT FROM CH2.DIENTHOAI@giamdoc1_dblink 
WHERE MADT NOT IN (SELECT MADT FROM CH2.CTHD@giamdoc1_dblink)






